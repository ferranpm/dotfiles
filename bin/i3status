#!/usr/bin/env bash

while [[ 1 ]]
do
    case $(mpc | grep "playing\|paused" | sed -e "s/\[\(.*\)\].*/\1/") in
        playing) playing_sym="▶ " ;;
        paused)  playing_sym="■ " ;;
        *)       playing_sym="♫" ;;
    esac
    music="[ $playing_sym$(mpc | grep ".* - .*") ]"

    volume="[ ♫: $(amixer get Master | grep '%' | sed -e 's/.*\[\([0-9]*%\)\].*/\1/') ]"

    acpi=$(acpi -b | sed -e "s/^.*, \([0-9]*%\).*$/\1/")
    if [[ $acpi ]]; then battery="[ Bat: $acpi ]"; fi

    date="[ $(date "+%a %G.%m.%d %H:%M") ]"

    wlan0=$(ip addr show dev wlan0 | grep "inet " | sed -e "s/.*inet \([0-9\.]*\).*/\1/")
    eth0=$(ip addr show dev eth0 | grep "inet " | sed -e "s/.*inet \([0-9\.]*\).*/\1/")
    inet="["
    if [[ $wlan0 ]]; then inet="$inet [ wlan0: $wlan0 ]"; fi
    if [[ $eth0 ]]; then inet="$inet [ eth0: $eth0 ]"; fi
    inet="$inet ]"

    echo "$music$volume$battery$inet$date"
    sleep 1
done
