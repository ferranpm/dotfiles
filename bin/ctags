#!/usr/bin/sh

ctags=/usr/bin/ctags
flags=-R\ --append

for f in $*; do
    case $f in
        *.c)
            gcc -M $f | \
                sed -e 's/[\\ ]/\n/g' | \
                sed -e '/^$/d' -e '/\.o:[ \t]*$/d' | \
                $ctags $flags -L -
            ;;
        *)
            $ctags $flags $f
    esac
done
